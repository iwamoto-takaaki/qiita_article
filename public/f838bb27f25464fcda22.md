---
title: scratchで落下と慣性の表現
tags:
  - 物理シミュレーション
  - Scratch
  - ゲームプログラミング
private: false
updated_at: '2019-01-17T14:49:38+09:00'
id: f838bb27f25464fcda22
organization_url_name: null
slide: false
ignorePublish: false
---
#はじめに
地元でやっているのCoderDojoってやつに参加してきました。長男はscratch3.0の新機能であるmicro:bitとの連携という今っぽいことをしておりました。他の子どもたちはどんなの組んでいるかなぁと聞き耳立てていたら「ジャンプってどう実装するんだろう」という話が聞こえてきたんですよ。

物理好きなおじさんとしては「どれどれ・・・」と行きたかったのですが、初参加というのもあり遠慮しました。帰ってきたらいつの間にか作っていたので公開します。とはいえ、落下と慣性に関する実装です。

ジャンプに関しては、ボタンを押したら常に同じ高さまでジャンプする方式と、マリオのように押し続けた長さでジャンプの高さが変わる方式がありますが後者をどうやったらscratchで組めるかについては状態の管理がちょっと難しそうですが、思いついたらやってみるかもしれません。

#とりあえずリンク
**[ニュートンとリンゴ](https://scratch.mit.edu/projects/279586796/)**

遊んでもらうことは目的としていないのですが、ちょっと慣れたお子様ならゲームとして完成させてくれることは難しくないでしょう。
いつものscatchのねこにかつらをかぶせてニュートンと名乗らせています。演算の内容としてはガリレオ・ガリレイですが、ピサの斜塔でクレイジークライマーを作るのはちょっと大変そうだったので・・・

#りんごの落下について
重力というのがどのように働くかというのを実装しています。
重力の表現としてはだんだん早くなるという表現が必要になりますが、実際の物理では時間当たりの早くなる速度というのは一定です。つまり、時間ごとに速度を変化させれは重力の表現ができます。

落下の表現はこれになります。
![apple2.JPG](https://qiita-image-store.s3.amazonaws.com/0/310093/6c9aac80-99a6-1123-8002-c0dce0e85498.jpeg)
0.1秒を1コマとして、１秒に3(ピクセル？)の加速をする設定にしています。数学で表現するとなかなか大変ですが、プログラムで書くと意外と単純なところがうれしいですね。喜びのあまり小学六年生の息子に見せました。
ゲームによって設定は変えるといいです。実際、りんごが落ちる表現として、表示されてから0.5秒後に落下を始める設定にしてあります。

#ねこのニュートンの慣性付きの移動について
慣性に関しても落下と同じでこのような動作を組んであります。

- 0.1秒ごとに速度分だけ移動させる
- 矢印キーを押されている間は2ずつ速度を上げる
- 速度の最大値は16とする
- やじるしの入力がないと速度は1ずつ下がる

最大速度に関しては、この場合は最高速度に達するのに1秒かからないので急に加速が止まっています。レースゲームで車の加速を表現するなら空気抵抗として速度に比例した反作用を付けると自然な加速の表現ができると思います。

##0.1秒ごとに速度分だけ移動させる

難しいことは何もないです。
![newton2.JPG](https://qiita-image-store.s3.amazonaws.com/0/310093/94e238c8-54f4-d00a-eb29-9538e4fc8c38.jpeg)

マイナスの値をとると左向きのに移動します。

##やじるしの入力がないと速度は1ずつ下がる

今度はちょっとややこしいです。

![newton3.JPG](https://qiita-image-store.s3.amazonaws.com/0/310093/c1498bc3-5275-8815-2d9c-64cdbd224bad.jpeg)

速度はプラスとマイナス両方を取りますので、速度を減らす向きが違いますので、もし～でなければを使っています。また、速度が0の場合も考慮に入れてあります。（さらに速度が整数を取らない場合や減速の係数が1でない場合などはもっと複雑になります。）

##矢印キーを押されている間は2ずつ速度を上げる
右と左ではプラスマイナスが違うだけなので右のみで・・・

![newton4.JPG](https://qiita-image-store.s3.amazonaws.com/0/310093/5eb5e2f1-87d4-4326-464b-add3c327063c.jpeg)

##速度の最大値は16とする

一歩手前で調整しないと速度は１６を超えてしまいます。
![newton5.JPG](https://qiita-image-store.s3.amazonaws.com/0/310093/6c6e1d7f-6598-c3f7-b760-86b10f45ad83.jpeg)

#さいごに

数式より簡単にかけたのでちょっとうれしいです。実際のコードは[　リンク　](https://scratch.mit.edu/projects/279586796/)を見てください。
できるだけ若い方にも読んでもらえるように書いたつもりですが、わからない部分について質問をお待ちします。
